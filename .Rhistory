head(g)
head(g, 10)
g %>% ggplot(aes(log2_dpd)) + geom_bar()
g %>% filter(year==1960 & !is.na()) %>% ggplot(aes(log2_dpd)) + geom_bar()
g %>% filter(year==1960 & !is.na(log2_dpd)) %>% ggplot(aes(log2_dpd)) + geom_bar()
g %>% filter(year==1960 & !is.na(log2_dpd))
g %>% filter(year==1960 & !is.na(log2_dpd)) %>% ggplot(aes(log2_dpd)) + geom_histogram()
g %>% filter(year==1970 & !is.na(log2_dpd)) %>% ggplot(aes(log2_dpd)) + geom_histogram()
g %>% filter(year==1970 & !is.na(log2_dpd)) %>% ggplot(aes(log2_dpd)) + geom_histogram(binwidth = 1, color = 'black')
g %>% filter(year==1970 & !is.na(dpd)) %>% ggplot(aes(dpd)) + geom_histogram(binwidth = 1, color = 'black')
g %>% filter(year==1970 & !is.na(dpd)) %>% ggplot(aes(dpd)) + geom_histogram(binwidth = 1, color = 'black') +
scale_x_continuous(trans = 'log2')
g %>% filter(year==1970 & region=='Caribbean')
g %>% filter(year==1970 & region=='Caribbean') %>% .$country
g %>% filter(year==1970 & region=='Caribbean') %>% .$country,$dpd
g %>% filter(year==1970 & region=='Caribbean') %>% .$country,dpd
g %>% filter(year==1970 & region=='Caribbean') %>% .$c(country,dpd)
g %>% filter(year==1970 & region=='Caribbean') %>% .c($country,$dpd)
g %>% filter(year==1970 & region=='Caribbean') %>% select(c('country', 'dpd'))
g %>% filter(year==1970 & region=='Caribbean') %>% select(c('country', 'dpd')) %>% select(dpd>45)
g %>% filter(year==1970 & region=='Caribbean') %>% select(c('country', 'dpd')) %>% select(.dpd>45)
g %>% filter(year==1970 & region=='Caribbean') %>% select(c('country', 'dpd')) %>% select($dpd>45)
g %>% filter(year==1970 & region=='Caribbean') %>% select(c('country', 'dpd')) %>% select(.$dpd>45)
g %>% filter(year==1970 & region=='Caribbean') %>% select(c('country', 'dpd')) %>% select(g$dpd>45)
g %>% filter(year==1970 & region=='Caribbean') %>% select(c('country', 'dpd'))
g %>% filter(year==1970 & region=='Caribbean') %>% select(c('country', 'dpd')) %>% select('dpd'>45)
g %>% filter(year==1970 & region=='Caribbean') %>% select(c('country', 'dpd')) %>% filter(dpd>45)
g %>% filter(year==1970 & region=='Caribbean') %>% select(c('country', 'dpd')) %>% filter(dpd<5)
g %>% filter(year==1970 & region=='Caribbean') %>% select(c('country', 'dpd')) %>% filter(dpd<10)
g %>% filter(year==1970 & region=='Caribbean') %>% select(c('country', 'dpd')) %>% filter(dpd<20)
g %>% filter(year==1970 & region=='Caribbean') %>% select(c('country', 'dpd')) %>% filter(dpd<40)
g %>% filter(year==1970 & region=='Caribbean') %>% select(c('country', 'dpd'))
g %>% filter(year==1970 & region=='Caribbean') %>% select(c('country', 'dpd')) %>% filter(dpd>40)
library(dslabs)
library(dplyr)
library(ggplot2)
data(gapminder)
head(gapminder)
g <- gapminder
labels <- data.frame(country = countries, x = c(1975, 1965), y = c(60, 72))
g %>% filter(year==2015 & country %in% c('Sri Lanka', 'Turkey')) %>% select(c('country', 'infant_mortality'))
countries <- c('South Korea', 'Germany')
g %>% filter(country %in% countries) %>% ggplot(aes(year, life_expectancy, col=country)) + geom_line()
labels <- data.frame(country = countries, x = c(1975, 1965), y = c(60, 72))
g %>% filter(country %in% countries) %>% ggplot(aes(year, life_expectancy, color=country)) + geom_line() +
geom_text(data = labels, aes(x, y, label=country)) + theme(legend.position = 'none')
g <- g %>% mutate(dpd = gdp/population/365)
g <- g %>% mutate(log2_dpd = log2(dpd))
#Log Value transformation
g %>% filter(year==1970 & !is.na(log2_dpd)) %>% ggplot(aes(log2_dpd)) + geom_histogram
#Log Value transformation
g %>% filter(year==1970 & !is.na(log2_dpd)) %>% ggplot(aes(log2_dpd)) + geom_histogram()
#Log Value transformation
g %>% filter(year==1970 & !is.na(log2_dpd)) %>% ggplot(aes(log2_dpd)) + geom_histogram(binwidth = 1, color = 'black')
#Log Scale transformation
g %>% filter(year==1970 & !is.na(dpd)) %>% ggplot(aes(dpd)) + geom_histogram(binwidth = 1, color = 'black') +
scale_x_continuous(trans = 'log2')
g %>% filter(year==1970 & region=='Caribbean') %>% select(c('country', 'dpd')) %>% filter(dpd>40)
head(g, 10)
#Stratify and Boxplot
levels(g['region'])
#Stratify and Boxplot
levels(g$region)
#Stratify and Boxplot
length(levels(g$region))
g %>% filter(year %in% past_year)
y
#boxplot by region in 1970
past_year <- 1970
g %>% filter(year %in% past_year)
g %>% filter(year %in% past_year) %>% ggplot(aes(region, dpd)) + geom_histogram()
g %>% filter(year %in% past_year) %>% ggplot(aes(region, dpd)) + geom_point()
g %>% filter(year == past_year & !is.na(dpd)) %>% ggplot(aes(region, dpd)) + geom_point()
p <- g %>% filter(year == past_year & !is.na(dpd)) %>% ggplot(aes(region, dpd))
p + geom_boxplot()
p + geom_boxplot() + theme(angle=90)
p + geom_boxplot()
p + geom_boxplot(col=continent)
p + geom_boxplot(col=continents)
head(g, 10)
p + geom_boxplot(color=continent)
p + geom_boxplot(color='blue')
p + geom_boxplot(fill='blue')
p + geom_boxplot(fill='region')
p + geom_boxplot(fill=continent)
p + geom_boxplot(fill='continent')
p + geom_boxplot(label=continent)
p + geom_boxplot(label='continent')
p + geom_boxplot(label=.$continent)
p + geom_boxplot(label=g$continent)
p + geom_boxplot(fill=g$continent)
p + geom_boxplot() + theme(axis.text.x = element_text(angle=90))
p + geom_boxplot() + theme(axis.text.x = element_text(angle=90, position=1))
p + geom_boxplot() + theme(axis.text.x = element_text(angle=90, x.position=1))
p + geom_boxplot() + theme(axis.text.x = element_text(angle=90, hjust=1))
p <- g %>% filter(year == past_year & !is.na(dpd)) %>% ggplot(aes(region, dpd, col=continent))
p + geom_boxplot()
p <- g %>% filter(year == past_year & !is.na(dpd)) %>% ggplot(aes(region, dpd, fill=continent))
p + geom_boxplot()
p + geom_boxplot() + theme(axis.text.x = element_text(angle=90, hjust=1))
g %>% filter(year == past_year & !is.na(dpd)) %>% mutate(region = reorder(region, dpd, FUN=median))
#reordering regions by median dpd for easier interpretation
p1 <- g %>% filter(year == past_year & !is.na(dpd)) %>% mutate(region = reorder(region, dpd, FUN=median)) %>%
ggplot(aes(region, dpd, col=continent))
p1 + geom_boxplot()
#reordering regions by median dpd for easier interpretation
p1 <- g %>% filter(year == past_year & !is.na(dpd)) %>% mutate(region = reorder(region, dpd, FUN=median)) %>%
ggplot(aes(region, dpd, fill=continent))
p1 + geom_boxplot()
p1 + geom_boxplot() + theme_classic()
p1 + geom_boxplot() + theme(axis.text.x = element_text(angle = 90, hjust = 1))
p1 + geom_boxplot() + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ggthemes::theme_economist()
p1 + geom_boxplot()  + ggthemes::theme_economist(axis.text.x = element_text(angle = 90, hjust = 1))
p1 + geom_boxplot() + theme(axis.text.x = element_text(angle = 90, hjust = 1))
p1 + geom_boxplot() + theme_classic(axis.text.x = element_text(angle = 90, hjust = 1))
p1 + geom_boxplot() + theme(axis.text.x = element_text(angle = 90, hjust = 1))
p1 + geom_boxplot() + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + xlab("")
p1 + geom_boxplot() + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + xlab("") + ylab("dollars per day")
#reordering regions by median dpd for easier interpretation
p1 <- g %>% filter(year == past_year & !is.na(dpd)) %>% mutate(region = reorder(region, dpd, FUN=median)) %>%
ggplot(aes(region, dpd, fill=continent)) + geom_boxplot() + theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
xlab("") + ylab("dollars per day")
p1  #plotting result
p1 + scale_y_continuous(trans = 'log2')
#between region with smallest dpd values
p1 + scale_y_continuous(trans = 'log2') + geom_point(show.legend = FALSE)
#reordering regions by median dpd for easier interpretation
p1 <- g %>% filter(year == past_year & !is.na(dpd)) %>% mutate(region = reorder(region, dpd, FUN=median)) %>%
ggplot(aes(region, dpd, fill=continent)) + geom_boxplot() + theme(axis.text.x = element_text(size = 11, angle = 90, hjust = 1)) +
xlab("") + ylab("dollars per day")
p1 + scale_y_continuous(trans = 'log2')   #plot with scale y log2 transformation. helps to see differences
#between region with smallest dpd values
p1 + scale_y_continuous(trans = 'log2') + geom_point(show.legend = FALSE)   #add data points to the plot
#Comparing distributions
#We will compare data for the western countries to developing countries
west <- c('Northern Europe', 'Northern America', 'Australia and New Zealand', 'Western Europe', 'Southern Europe')
g %>% filter(year==past_year & !is.na(dpd)) %>% mutate(group = if_else(region %in% west, 'West', 'Developping')) %>%
ggplot(aes(group, dpd))
p3 <- g %>% filter(year==past_year & !is.na(dpd)) %>% mutate(group = if_else(region %in% west, 'West', 'Developping')) %>%
ggplot(aes(group, dpd))
p3 <- g %>% filter(year==past_year & !is.na(dpd)) %>% mutate(group = if_else(region %in% west, 'West', 'Developping')) %>%
ggplot(aes(group, dpd, col=region))
p3 + geom_line()
p3 <- g %>% filter(year==past_year & !is.na(dpd)) %>% mutate(group = if_else(region %in% west, 'West', 'Developping')) %>%
ggplot(aes(group, dpd, col=group))
p3 + geom_line()
p3 + geom_boxplot()
p3 + geom_histogram()
p3 <- g %>% filter(year==past_year & !is.na(dpd)) %>% mutate(group = if_else(region %in% west, 'West', 'Developping')) %>%
ggplot(aes(dpd, col=group))
p3 <- g %>% filter(year==past_year & !is.na(dpd)) %>% mutate(group = if_else(region %in% west, 'West', 'Developping')) %>%
ggplot(aes(dpd, fill=group))
p3 + geom_histogram()
p3 + geom_histogram(binwidth = 1, col = 'black')
p3 + geom_histogram(binwidth = 1, col = 'black') + scale_x_continuous(trans = 'log2')
p3 + geom_histogram(binwidth = 1, col = 'black') + scale_x_continuous(trans = 'log2') + facet_grid()
p3 + geom_histogram(binwidth = 1, col = 'black') + scale_x_continuous(trans = 'log2') + facet_grid(.~group)
p4 <- g %>% filter(year == c(past_year, present_year) & !is.na(dpd)) %>% mutate(group = if_else(region %in% west, 'West', 'Developping')) %>%
ggplot(aes(dpd, fill=group))
p4 <- g %>% filter(year %in% c(past_year, present_year) & !is.na(dpd)) %>% mutate(group = if_else(region %in% west, 'West', 'Developping')) %>%
ggplot(aes(dpd, fill=group))
present_year <- 2010
p4 <- g %>% filter(year %in% c(past_year, present_year) & !is.na(dpd)) %>% mutate(group = if_else(region %in% west, 'West', 'Developping')) %>%
ggplot(aes(dpd, fill=group))
p4 <- g %>% filter(year == c(past_year, present_year) & !is.na(dpd)) %>% mutate(group = if_else(region %in% west, 'West', 'Developping')) %>%
ggplot(aes(dpd, fill=group))
p4 <- g %>% filter(year %in% c(past_year, present_year) & !is.na(dpd)) %>% mutate(group = if_else(region %in% west, 'West', 'Developping')) %>%
ggplot(aes(dpd, fill=group))
p4 + geom_histogram(binwidth = 1, col = 'black') + scale_x_continuous(trans = 'log2') + facet_grid(year~group)
p4 + geom_histogram(binwidth = 1, col = 'black') + scale_x_continuous(trans = 'log2') + facet_grid(year~group) + geom_smooth()
p4 + geom_histogram(binwidth = 1, col = 'black') + scale_x_continuous(trans = 'log2') + facet_grid(year~group)
p3 + geom_histogram(binwidth = 1, col = 'black')  #here we plot the 2 distributions histogram
p3 + geom_histogram(binwidth = 1, col = 'black') + scale_x_continuous(trans = 'log2') #plotting with scale x log 2 transformation
p3 + geom_histogram(binwidth = 1, col = 'black') + scale_x_continuous(trans = 'log2') + facet_grid(.~group)  #faceting two plots for with respect to each distribution
p3 + geom_histogram(binwidth = 1, col = 'black') + scale_x_continuous(trans = 'log2') + geom_smooth() #plotting with scale x log 2 transformation
p4 + geom_histogram(binwidth = 1, col = 'black') + scale_x_continuous(trans = 'log2') + facet_grid(year~group)
g %>% filter(year %in% c(past_year, present_year) & !is.na(dpd)) %>% mutate(group = if_else(region %in% west, 'West', 'Developping')) %>%
ggplot(aes(region, dpd, fill=factor(year))) + geom_boxplot()
g %>% filter(year %in% c(past_year, present_year) & !is.na(dpd)) %>% mutate(group = if_else(region %in% west, 'West', 'Developping')) %>%
ggplot(aes(region, dpd, fill=factor(year))) + geom_boxplot() + theme(axis.text.x = element_text(angle=90, hjust = 1))
g %>% filter(year %in% c(past_year, present_year) & !is.na(dpd)) %>% mutate(group = if_else(region %in% west, 'West', 'Developping')) %>%
ggplot(aes(region, dpd, fill=factor(year))) + geom_boxplot() + theme(axis.text.x = element_text(angle=90, hjust = 1)) +
scale_color_discrete(names='Year')
g %>% filter(year %in% c(past_year, present_year) & !is.na(dpd)) %>% mutate(group = if_else(region %in% west, 'West', 'Developping')) %>%
ggplot(aes(region, dpd, fill=factor(year))) + geom_boxplot() + theme(axis.text.x = element_text(angle=90, hjust = 1)) +
scale_color_discrete(name='Year')
g %>% filter(year %in% c(past_year, present_year) & !is.na(dpd)) %>% mutate(group = if_else(region %in% west, 'West', 'Developping')) %>%
ggplot(aes(region, dpd, fill=factor(year))) + geom_boxplot() + theme(axis.text.x = element_text(angle=90, hjust = 1)) +
scale_color_discrete(name='Year')
g %>% filter(year %in% c(past_year, present_year) & !is.na(dpd)) %>% mutate(group = if_else(region %in% west, 'West', 'Developping')) %>%
ggplot(aes(region, dpd, fill=factor(year))) + geom_boxplot() + theme(axis.text.x = element_text(angle=90, hjust = 1)) +
scale_color_discrete(name='Year')
g %>% filter(year %in% c(past_year, present_year) & !is.na(dpd)) %>% mutate(group = if_else(region %in% west, 'West', 'Developping')) %>%
ggplot(aes(region, dpd, fill=factor(year))) + geom_boxplot() + theme(axis.text.x = element_text(angle=90, hjust = 1)) +
scale_fill_discrete(name='Year')
head(g)
#comparing the years on same graph using boxplot
g %>% filter(year %in% c(past_year, present_year) & !is.na(dpd)) %>%
ggplot(aes(region, dpd, fill=factor(year))) + geom_boxplot() + theme(axis.text.x = element_text(angle=90, hjust = 1)) +
scale_fill_discrete(name='Year')
#comparing the years on same graph using boxplot
g %>% filter(year %in% c(past_year, present_year) & !is.na(dpd)) %>%
ggplot(aes(region, dpd, fill=factor(year))) + geom_boxplot() + theme(axis.text.x = element_text(angle=90, hjust = 1)) +
scale_fill_discrete(name='Year') + scale_y_continuous(trans = 'log2')
#comparing the years on same graph using boxplot
g %>% filter(year %in% c(past_year, present_year) & !is.na(dpd)) %>% mutate(region, dpd, FUN=median)
#comparing the years on same graph using boxplot
g %>% filter(year %in% c(past_year, present_year) & !is.na(dpd)) %>% mutate(region, dpd, FUN='median')
g %>% filter(year %in% c(past_year, present_year) & !is.na(dpd)) %>% mutate(region, dpd, FUN='median')
ggplot(aes(region, dpd, fill=factor(year))) + geom_boxplot() + theme(axis.text.x = element_text(angle=90, hjust = 1)) +
scale_fill_discrete(name='Year') + scale_y_continuous(trans = 'log2')
g %>% filter(year %in% c(past_year, present_year) & !is.na(dpd)) %>% mutate(region, dpd, FUN=median)
#comparing the years on same graph using boxplot
g %>% filter(year %in% c(past_year, present_year) & !is.na(dpd)) %>% mutate(region = reoder(region, dpd, FUN=median))
#comparing the years on same graph using boxplot
g %>% filter(year %in% c(past_year, present_year) & !is.na(dpd)) %>% mutate(region = reorder(region, dpd, FUN=median))
g %>% filter(year %in% c(past_year, present_year) & !is.na(dpd)) %>% mutate(region = reorder(region, dpd, FUN=median))
ggplot(aes(region, dpd, fill=factor(year))) + geom_boxplot() + theme(axis.text.x = element_text(angle=90, hjust = 1)) +
scale_fill_discrete(name='Year') + scale_y_continuous(trans = 'log2')
#comparing the years on same graph using boxplot
g %>% filter(year %in% c(past_year, present_year) & !is.na(dpd)) %>% mutate(region = reorder(region, dpd, FUN=median)) %>%
ggplot(aes(region, dpd, fill=continent)) + geom_boxplot() + theme(axis.text.x = element_text(angle=90, hjust = 1)) +
scale_fill_discrete(name='Year') + scale_y_continuous(trans = 'log2')
#comparing the years on same graph using boxplot
g %>% filter(year %in% c(past_year, present_year) & !is.na(dpd)) %>% mutate(region = reorder(region, dpd, FUN=median)) %>%
ggplot(aes(region, dpd, fill=continent)) + geom_boxplot() + theme(axis.text.x = element_text(angle=90, hjust = 1)) +
facet_grid(year~.) + scale_y_continuous(trans = 'log2')
#comparing the years on same graph using boxplot
g %>% filter(year %in% c(past_year, present_year) & !is.na(dpd)) %>% mutate(region = reorder(region, dpd, FUN=median)) %>%
ggplot(aes(region, dpd, fill=continent)) + geom_boxplot() + theme(axis.text.x = element_text(angle=90, hjust = 1)) +
facet_grid(year~.) + scale_y_continuous(trans = 'log2') + scale_fill_discrete(name='Continent')
#comparing the years on same graph using boxplot
g %>% filter(year %in% c(past_year, present_year) & !is.na(dpd)) %>% mutate(region = reorder(region, dpd, FUN=median)) %>%
ggplot(aes(region, dpd, fill=continent)) + geom_boxplot() + theme(axis.text.x = element_text(angle=90, hjust = 1)) +
facet_grid(year~.) + scale_y_continuous(trans = 'log2') + scale_fill_discrete(name='Continent') + xlab("")
#comparing the years on same graph using boxplot
g %>% filter(year %in% c(past_year, present_year) & !is.na(dpd)) %>% mutate(region = reorder(region, dpd, FUN=median)) %>%
ggplot(aes(region, dpd, fill=continent)) + geom_boxplot() + theme(axis.text.x = element_text(angle=90, hjust = 1)) +
facet_grid(.~year) + scale_y_continuous(trans = 'log2') + scale_fill_discrete(name='Continent') + xlab("")
.
#comparing the years on same graph using boxplot
g %>% filter(year %in% c(past_year, present_year) & !is.na(dpd)) %>% mutate(region = reorder(region, dpd, FUN=median)) %>%
ggplot(aes(region, dpd, fill=continent)) + geom_boxplot() + theme(axis.text.x = element_text(angle=90, hjust = 1)) +
facet_grid(year~.) + scale_y_continuous(trans = 'log2') + scale_fill_discrete(name='Continent') + xlab("")
#comparing the years on same graph using boxplot
p5 <- g %>% filter(year %in% c(past_year, present_year) & !is.na(dpd)) %>% mutate(region = reorder(region, dpd, FUN=median)) %>%
ggplot(aes(region, dpd, fill=continent)) + theme(axis.text.x = element_text(angle=90, hjust = 1)) +
scale_y_continuous(trans = 'log2') + scale_fill_discrete(name='Continent') + xlab("")
p5 + geom_boxplot() + facet_grid(year~.)
#comparing the years on same graph using boxplot
p5 <- g %>% filter(year %in% c(past_year, present_year) & !is.na(dpd)) %>% mutate(region = reorder(region, dpd, FUN=median)) %>%
ggplot(aes(region, dpd)) + theme(axis.text.x = element_text(angle=90, hjust = 1)) +
scale_y_continuous(trans = 'log2') + scale_fill_discrete(name='Continent') + xlab("")
p5 + geom_boxplot() + facet_grid(year~.)
p5 + geom_boxplot(aes(fill=continent)) + facet_grid(year~.)
p5 + geom_boxplot(aes(fill=factor(year)))
p5 + geom_boxplot(aes(fill=factor(year))) + scale_fill_discrete(name='Year')
library(dslabs)
library(dplyr)
library(ggplot2)
data(gapminder)
head(gapminder)
g <- gapminder
#Density Plots
#Faceted smooth density plots - area under each curves adds to 1
#first, let's built a list of countries which data exist in both 1970 and 2010 years
list1 <- g %>% filter(year==1970) %>% .$country
list1
g <- g %>% mutate(dpd = gdp/population/365)
g <- g %>% mutate(log2_dpd = log2(dpd))
head(g)
#Density Plots
#Faceted smooth density plots - area under each curves adds to 1
#first, let's built a list of countries which data exist in both 1970 and 2010 years
list1 <- g %>% filter(year==1970 & !is.na(dpd)) %>% .$country
list1
list2 <- g %>% filter(year==2010 & !is.na(dpd)) %>% .$country
countries <- intersect(list1, list2)
countries
length(list1)
length(list2)
length(countries)
#now we'll built a faceted smooth density plots - area under each curves adds to 1
p6 <- g %>% filter(year %in% c(past_year, present_year) & country %in% countries) %>% ggplot(aes(dpd))
#boxplot by region in 1970
past_year <- 1970
#faceting by west/developing and year
present_year <- 2010
#now we'll built a faceted smooth density plots - area under each curves adds to 1
p6 <- g %>% filter(year %in% c(past_year, present_year) & country %in% countries) %>% ggplot(aes(dpd))
p6 + geom_density()
p6 + geom_density(aes(col=region))
#Comparing distributions
#We will compare data for the western countries to developing countries
west <- c('Northern Europe', 'Northern America', 'Australia and New Zealand', 'Western Europe', 'Southern Europe')
#now we'll built a faceted smooth density plots - area under each curves adds to 1
p6 <- g %>% filter(year %in% c(past_year, present_year) & country %in% countries) %>%
mutate(group = if_else(region %in% west, 'West', 'Developing')) %>% ggplot(aes(dpd))
p6 + geom_density(aes(col=group))
#now we'll built a faceted smooth density plots - area under each curves adds to 1
g %>% filter(year %in% c(past_year, present_year) & country %in% countries) %>%
mutate(group = if_else(region %in% west, 'West', 'Developing')) %>% summarise(n=n())
g %>% filter(year %in% c(past_year, present_year) & country %in% countries) %>%
mutate(group = if_else(region %in% west, 'West', 'Developing'))
#now we'll built a faceted smooth density plots - area under each curves adds to 1
g %>% filter(year %in% c(past_year, present_year) & country %in% countries) %>%
mutate(group = if_else(region %in% west, 'West', 'Developing')) %>% summarise(n=n()) %>% knitr::kable()
g %>% filter(year %in% c(past_year, present_year) & country %in% countries) %>%
mutate(group = if_else(region %in% west, 'West', 'Developing')) %>% summarise(n=n())
#now we'll built a faceted smooth density plots - area under each curves adds to 1
g %>% filter(year %in% c(past_year, present_year) & country %in% countries) %>%
mutate(group = if_else(region %in% west, 'West', 'Developing')) %>% group_by(group) %>% summarise(n=n()) %>%
knitr::kable()
p6 <- g %>% filter(year %in% c(past_year, present_year) & country %in% countries) %>%
mutate(group = if_else(region %in% west, 'West', 'Developing')) %>% group_by(group) %>% ggplot(aes(dpd))
p6 + geom_density(aes(col=group))
p3 <- g %>% filter(year==past_year & !is.na(dpd)) %>% mutate(group = if_else(region %in% west, 'West', 'Developping')) %>%
ggplot(aes(dpd, fill=group))
p3 + geom_histogram(binwidth = 1, col = 'black')  #here we plot the 2 distributions histogram
p3 + geom_histogram(binwidth = 1, col = 'black') + scale_x_continuous(trans = 'log2')  #plotting with scale x log 2 transformation
p3 + geom_histogram(binwidth = 1, col = 'black') + scale_x_continuous(trans = 'log2') + facet_grid(.~group)  #faceting two plots for with respect to each distribution
p4 <- g %>% filter(year %in% c(past_year, present_year) & !is.na(dpd)) %>% mutate(group = if_else(region %in% west, 'West', 'Developping')) %>%
ggplot(aes(dpd, fill=group))
p4 + geom_histogram(binwidth = 1, col = 'black') + scale_x_continuous(trans = 'log2') + facet_grid(year~group)
#comparing the years using boxplot
p5 <- g %>% filter(year %in% c(past_year, present_year) & !is.na(dpd)) %>% mutate(region = reorder(region, dpd, FUN=median)) %>%
ggplot(aes(region, dpd)) + theme(axis.text.x = element_text(angle=90, hjust = 1)) +
scale_y_continuous(trans = 'log2') + xlab("")
p5 + geom_boxplot(aes(fill=continent)) + facet_grid(year~.) + scale_fill_discrete(name='Continent')  #by faceting graphs
p5 + geom_boxplot(aes(fill=factor(year))) + scale_fill_discrete(name='Year') #on same graph
years <- c(past_year, present_year)
years
countries
years
years <- c(past_year, present_year, 1205, 1548, 1365, 2587)
years
years <- c(past_year, present_year)
p6 <- g %>% filter(year %in% years & country %in% countries) %>% ggplot(aes(dpd))
p6 + facet_grid(year~.) + geom_density()
p + geom_boxplot() #raw plot
p3 + geom_histogram(binwidth = 1, col = 'black')  #here we plot the 2 distributions histogram
p <- g %>% filter(year == past_year & !is.na(dpd)) %>% ggplot(aes(region, dpd, fill=continent))
p + geom_boxplot() #raw plot
p + geom_boxplot() + theme(axis.text.x = element_text(angle=90, hjust=1)) #plot with ajusted names on the x axis
#reordering regions by median dpd for easier interpretation
p1 <- g %>% filter(year == past_year & !is.na(dpd)) %>% mutate(region = reorder(region, dpd, FUN=median)) %>%
ggplot(aes(region, dpd, fill=continent)) + geom_boxplot() + theme(axis.text.x = element_text(size = 11, angle = 90, hjust = 1)) +
xlab("") + ylab("dollars per day")
p1  #plotting result
p1 + scale_y_continuous(trans = 'log2')   #plot with scale y log2 transformation. helps to see differences
#between region with smallest dpd values
p1 + scale_y_continuous(trans = 'log2') + geom_point(show.legend = FALSE)   #add data points to the plot
p6 <- g %>% filter(year %in% years & country %in% countries) %>% ggplot(aes(dpd))
p6 + facet_grid(year~.) + geom_density(alpha = 0.2, bw = 0.75)
p6 <- g %>% filter(year %in% years & country %in% countries)
p6
p6 <- g %>% filter(year %in% years & country %in% countries) %>% ggplot(aes(dpd))
p6 + facet_grid(year~.) + geom_density(alpha = 0.2, bw = 0.75) + scale_x_continuous(trans = 'log2')
p6 + facet_grid(year~.) + geom_density(alpha = 0.5, bw = 0.75) + scale_x_continuous(trans = 'log2')
p6 + facet_grid(year~.) + geom_density(alpha = 0.1, bw = 0.75) + scale_x_continuous(trans = 'log2')
vignette("ggplot2-specs")
p6 + facet_grid(year~.) + geom_density(alpha = 0.2, bw = 0.5) + scale_x_continuous(trans = 'log2')
p6 + facet_grid(year~.) + geom_density(alpha = 0.2, bw = 0.2) + scale_x_continuous(trans = 'log2')
p6 + facet_grid(year~.) + geom_density(alpha = 0.2, bw = 0.1) + scale_x_continuous(trans = 'log2')
p6 + facet_grid(year~.) + geom_density(alpha = 0.2, bw = 0.8) + scale_x_continuous(trans = 'log2')
p6 + facet_grid(year~.) + geom_density(alpha = 0.2, bw = 0.7) + scale_x_continuous(trans = 'log2')
p6 + facet_grid(year~.) + geom_density(alpha = 0.2, bw = 0.8) + scale_x_continuous(trans = 'log2')
p6 + facet_grid(year~.) + geom_density(alpha = 0.2, bw = 0.6) + scale_x_continuous(trans = 'log2')
p6 + facet_grid(year~.) + geom_density(alpha = 0.2, bw = 0.9) + scale_x_continuous(trans = 'log2')
p6 + facet_grid(year~.) + geom_density(alpha = 0.2, bw = 0.75) + scale_x_continuous(trans = 'log2')
p6 + facet_grid(year~.) + geom_density(alpha = 8, bw = 0.75, ) + scale_x_continuous(trans = 'log2')
p6 + facet_grid(year~.) + geom_density(alpha = 8, bw = 0.75, ) + scale_x_continuous(trans = 'log2')
p6 + facet_grid(year~.) + geom_density(alpha = 1000, bw = 0.75, ) + scale_x_continuous(trans = 'log2')
p6 + facet_grid(year~.) + geom_density(alpha = 0, bw = 0.75, ) + scale_x_continuous(trans = 'log2')
p6 <- g %>% filter(year %in% years & country %in% countries) %>% ggplot(aes(dpd, fill='grey'))
p6 + facet_grid(year~.) + geom_density(alpha = 0.2, bw = 0.75) + scale_x_continuous(trans = 'log2')
p6 <- g %>% filter(year %in% years & country %in% countries) %>% ggplot(aes(dpd, fill='gray'))
p6 + facet_grid(year~.) + geom_density(alpha = 0.2, bw = 0.75) + scale_x_continuous(trans = 'log2')
p6 <- g %>% filter(year %in% years & country %in% countries) %>% ggplot(aes(dpd, fill='black'))
p6 + facet_grid(year~.) + geom_density(alpha = 0.2, bw = 0.75) + scale_x_continuous(trans = 'log2')
p6 <- g %>% filter(year %in% years & country %in% countries) %>% ggplot(aes(dpd, fill=grey))
p6 + facet_grid(year~.) + geom_density(alpha = 0.2, bw = 0.75) + scale_x_continuous(trans = 'log2')
p6 <- g %>% filter(year %in% years & country %in% countries) %>% ggplot(aes(dpd, fill='blue'))
p6 + facet_grid(year~.) + geom_density(alpha = 0.2, bw = 0.75) + scale_x_continuous(trans = 'log2')
p6 + facet_grid(year~.) + geom_density(alpha = 0.2, bw = 0.75, fill='blue') + scale_x_continuous(trans = 'log2')
p6 <- g %>% filter(year %in% years & country %in% countries) %>% ggplot(aes(dpd))
p6 + facet_grid(year~.) + geom_density(alpha = 0.2, bw = 0.75, fill='blue') + scale_x_continuous(trans = 'log2')
p6 + facet_grid(year~.) + geom_density(alpha = 0.2, bw = 0.75, fill='gray') + scale_x_continuous(trans = 'log2')
p6 + facet_grid(year~.) + geom_density(alpha = 0.2, bw = 0.75, fill='grey') + scale_x_continuous(trans = 'log2')
p6 + facet_grid(year~.) + geom_density(alpha = 0.2, bw = 0.75, fill='black') + scale_x_continuous(trans = 'log2')
p6 + facet_grid(year~.) + geom_density(alpha = 0.2, bw = 0.75, fill=year) + scale_x_continuous(trans = 'log2')
p6 + facet_grid(year~.) + geom_density(alpha = 0.2, bw = 0.75, aes(fill=year)) + scale_x_continuous(trans = 'log2')
p6 + facet_grid(year~.) + geom_density(alpha = 0.2, bw = 0.75, aes(fill=years)) + scale_x_continuous(trans = 'log2')
p6 + facet_grid(year~.) + geom_density(alpha = 0.2, bw = 0.75, fill='blue') + scale_x_continuous(trans = 'log2')
g %>% filter(year %in% years & country %in% countries) %>%
mutate(group = if_else(region %in% west, 'West', 'Developing')) %>% group_by(group) %>% summarise(n=n())
g %>% filter(year %in% years & country %in% countries) %>%
mutate(group = if_else(region %in% west, 'West', 'Developing')) %>% group_by(group) %>% summarise(n=n()) %>%
knitr::kable()
p7 <- g %>% filter(year %in% years & country %in% countries) %>%
mutate(group = if_else(region %in% west, 'West', 'Developing')) %>% ggplot(aes(dpd))
p7 + geom_density(aes(fill=group)) + facet_grid(year~.)
p7 + geom_density(aes(fill=group)) + facet_grid(year~.) + scale_x_continuous(trans = 'log2')
p7 + geom_density(alpha = 0.2, aes(fill=group)) + facet_grid(year~.) + scale_x_continuous(trans = 'log2')
#a faceted smooth density plots - area under each curves adds to 1
p6 + facet_grid(year~.) + geom_density(alpha = 0.2, bw = 0.75, fill='blue') + scale_x_continuous(trans = 'log2')
#a faceted smooth density plots - area under each curves adds to 1
p6 + facet_grid(year~.) + geom_density(alpha = 1, bw = 0.75, fill='blue') + scale_x_continuous(trans = 'log2')
#a faceted smooth density plots - area under each curves adds to 1
p6 + facet_grid(year~.) + geom_density(alpha = 0.5, bw = 0.75, fill='blue') + scale_x_continuous(trans = 'log2')
p7 + geom_density(alpha = 0.2, aes(fill=group)) + facet_grid(year~.) + scale_x_continuous(trans = 'log2')
p7 + geom_density(alpha = 0.2, bw = 0.75, aes(fill=group)) + facet_grid(year~.) + scale_x_continuous(trans = 'log2')
p7 + geom_density(alpha = 0.2, aes(fill=group)) + facet_grid(year~.) + scale_x_continuous(trans = 'log2')
p8 <- g %>% filter(year %in% years & country %in% countries) %>%
mutate(group = if_else(region %in% west, 'West', 'Developing')) %>% ggplot(aes(x = dpd, y = ..count..))
p8 + geom_density(alpha = 0.2, aes(fill=group)) + facet_grid(year~.) + scale_x_continuous(trans = 'log2')   #plot the numbers in the y axis
p8 + geom_density(alpha = 0.2, bw = 0.75, aes(fill=group)) + facet_grid(year~.) + scale_x_continuous(trans = 'log2')   #plot the numbers in the y axis
g %>% mutate(group = case_when(
.$region %in% west ~ 'West',
.$region %in% c('Eastern Asia', 'South-Eastern Asia') ~ 'East Asia',
.$region %in% c('Caribbean', 'Central America', 'South America') ~ 'Latin America',
.$continent == 'Africa' & .$region != 'Northern Africa' ~ 'Sub-Saharan Africa',
TRUE ~ 'Others'))
g <- g %>% mutate(group = case_when(
.$region %in% west ~ 'West',
.$region %in% c('Eastern Asia', 'South-Eastern Asia') ~ 'East Asia',
.$region %in% c('Caribbean', 'Central America', 'South America') ~ 'Latin America',
.$continent == 'Africa' & .$region != 'Northern Africa' ~ 'Sub-Saharan Africa',
TRUE ~ 'Others'))
g$group <- factor(g$group, levels = c('Others', 'Latin America', 'East Asia', 'Sub-Saharan Africa', 'West'))
levels(g$group)
p9 <- g %>% filter(year %in% years & country %in% countries) %>% ggplot(aes(x = dpd, y = ..count..))
p9 + geom_density(alpha = 0.2, bw = 0.75, aes(fill=group)) + facet_grid(year~.) + scale_x_continuous(trans = 'log2')
p9 + geom_density(alpha = 0.2, bw = 0.75, aes(fill=group), position = 'stack') + facet_grid(year~.) + scale_x_continuous(trans = 'log2')
g %>% filter(year %in% years & country %in% countries) %>% group_by(year) %>% mutate(weight = population/sum(population)*2) %>% ungroup()
g %>% filter(year %in% years & country %in% countries) %>% group_by(year) %>% mutate(weight = (population/sum(population))*2) %>% ungroup()
g %>% filter(year %in% years & country %in% countries) %>% group_by(year) %>% mutate(weight = population/sum(population)*10) %>% ungroup()
#setting a weight regarding population size
g <- g %>% filter(year %in% years & country %in% countries) %>% group_by(year) %>% mutate(weight = population/sum(population)*10) %>% ungroup()
max(g$weight)
g$country(max(g$weight))
g$country[max(g$weight)]
#setting a weight regarding population size
g <- g %>% filter(year %in% years & country %in% countries) %>% group_by(year) %>% mutate(weight = population/sum(population)*2) %>% ungroup()
max(g$weight)
#new graph
p10 <- g %>% filter(year %in% years & country %in% countries) %>% ggplot(aes(dpd, y = ..count.., weight = weight))
p10 + geom_density(alpha = 0.2, bw = 0.75, aes(fill=group), position = 'stack') + facet_grid(year~.) + scale_x_continuous(trans = 'log2')
#new graph
p10 <- g %>% filter(year %in% years & country %in% countries) %>% ggplot(aes(dpd, y = ..count.., weight = weight))
p10 + geom_density(alpha = 0.2, bw = 0.75, aes(fill=group), position = 'stack') + facet_grid(year~.) + scale_x_continuous(trans = 'log2')
p10 + geom_density(alpha = 0.2, aes(fill=group), position = 'stack') + facet_grid(year~.) + scale_x_continuous(trans = 'log2')
p10 + geom_density(alpha = 0.2, bw = 0.75, aes(fill=group), position = 'stack') + facet_grid(year~.) + scale_x_continuous(trans = 'log2')
#setting a weight regarding population size
g <- g %>% filter(year %in% years & country %in% countries) %>% group_by(year) %>% mutate(weight = population/sum(population*2)) %>% ungroup()
#new graph
p10 <- g %>% filter(year %in% years & country %in% countries) %>% ggplot(aes(dpd, y = ..count.., weight = weight))
p10 + geom_density(alpha = 0.2, bw = 0.75, aes(fill=group), position = 'stack') + facet_grid(year~.) + scale_x_continuous(trans = 'log2')
#new graph
p10 <- g %>% filter(year %in% years & country %in% countries) %>% ggplot(aes(dpd, weight = weight))
p10 + geom_density(alpha = 0.2, bw = 0.75, aes(fill=group), position = 'stack') + facet_grid(year~.) + scale_x_continuous(trans = 'log2')
#setting a weight regarding population size
g <- g %>% filter(year %in% years & country %in% countries) %>% group_by(year) %>% mutate(weight = population/sum(population)*2) %>% ungroup()
#new graph
p10 <- g %>% filter(year %in% years & country %in% countries) %>% ggplot(aes(dpd, weight = weight))
p10 + geom_density(alpha = 0.2, bw = 0.75, aes(fill=group), position = 'stack') + facet_grid(year~.) + scale_x_continuous(trans = 'log2')
#setting a weight regarding population size
g <- g %>% filter(year %in% years & country %in% countries) %>% group_by(year) %>% mutate(weight = population/sum(population*2)) %>% ungroup()
#new graph
p10 <- g %>% filter(year %in% years & country %in% countries) %>% ggplot(aes(dpd, weight = weight))
p10 + geom_density(alpha = 0.2, bw = 0.75, aes(fill=group), position = 'stack') + facet_grid(year~.) + scale_x_continuous(trans = 'log2')
g %>% filter(year %in% years & country %in% countries) %>% group_by(year) %>% mutate(weight = population/sum(population*2)) %>% ungroup() %>%
ggplot(aes(dpd, fill = group, weight = weight)) + scale_x_continuous(trans = 'log2') + geom_density(alpha = 0.2, bw = 0.75, position = 'stack') +
facet_grid(year~.)
g <- g %>% mutate(group = case_when(
.$region %in% west ~ 'West',
.$region %in% c("Eastern Asia", "South-Eastern Asia") ~ 'East Asia',
.$region %in% c("Caribbean", "Central America", "South America") ~ 'Latin America',
.$continent == "Africa" & .$region != "Northern Africa" ~ 'Sub-Saharan Africa',
TRUE ~ 'Others'))
g %>% filter(year %in% years & country %in% countries) %>% group_by(year) %>% mutate(weight = population/sum(population*2)) %>% ungroup() %>%
ggplot(aes(dpd, fill = group, weight = weight)) + scale_x_continuous(trans = 'log2') + geom_density(alpha = 0.2, bw = 0.75, position = 'stack') +
facet_grid(year~.)
#Ecological fallacy
g <- g %>% mutate(group = case_when(
.$region %in% west ~ 'The West',
.$region %in% 'Northern Africa' ~ 'Northern Africa',
.$region %in% c('Eastern Asia', 'South-Eastern Asia') ~ 'East Asia',
.$region %in% 'Southern Asia' ~ 'Southern Asia',
.$region %in% c('Caribbean', 'Central America', 'South America') ~ 'Latin America',
.$continent == 'Africa' & .$region != 'Northern Africa' ~ 'Sub-Saharan Africa',
.$region %in% c("Melanesia", "Micronesia", "Polynesia") ~ "Pacific Islands"))
surv_income <- g %>%
filter(year %in% present_year & !is.na(gdp) & !is.na(infant_mortality) & !is.na(group)) %>%
group_by(group) %>%
summarize(income = sum(gdp)/sum(population)/365,
infant_survival_rate = 1 - sum(infant_mortality/1000*population)/sum(population))
surv_income
surv_income %>% arrange(income)
# plot infant survival versus income, with transformed axes
surv_income %>% ggplot(aes(income, infant_survival_rate, label = group, color = group)) +
scale_x_continuous(trans = "log2", limit = c(0.25, 150)) +
scale_y_continuous(trans = "logit", limit = c(0.875, .9981),
breaks = c(.85, .90, .95, .99, .995, .998)) +
geom_label(size = 3, show.legend = FALSE)
ds_theme_set()
# plot infant survival versus income, with transformed axes
surv_income %>% ggplot(aes(income, infant_survival_rate, label = group, color = group)) +
scale_x_continuous(trans = "log2", limit = c(0.25, 150)) +
scale_y_continuous(trans = "logit", limit = c(0.875, .9981),
breaks = c(.85, .90, .95, .99, .995, .998)) +
geom_label(size = 3, show.legend = FALSE)
